(async function(){const c=document.getElementById('gallery');if(!c)return;let fotos=[];try{const r=await fetch('assets/fotos/fotos.json',{cache:'no-store'});fotos=await r.json();}catch(e){console.warn('No existe fotos.json o JSON invÃ¡lido.',e);}const nodes=fotos.map((p,i)=>{const a=document.createElement('a');a.href=p.src;a.dataset.index=i;const img=document.createElement('img');img.loading='lazy';img.alt=p.alt||'Foto';img.src=p.thumb||p.src;a.appendChild(img);return a;});nodes.forEach(n=>c.appendChild(n));const lb=document.getElementById('lightbox');if(!lb)return;const img=lb.querySelector('img');const bC=lb.querySelector('.close');const bP=lb.querySelector('.prev');const bN=lb.querySelector('.next');let cur=0;function open(i){cur=i;const p=fotos[cur];img.src=p.src;img.alt=p.alt||'Foto';lb.classList.add('open');lb.setAttribute('aria-hidden','false');}function close(){lb.classList.remove('open');lb.setAttribute('aria-hidden','true');img.src='';}function prev(){open((cur-1+fotos.length)%fotos.length);}function next(){open((cur+1)%fotos.length);}c.addEventListener('click',(e)=>{const a=e.target.closest('a');if(!a)return;e.preventDefault();open(parseInt(a.dataset.index,10));});bC.addEventListener('click',close);bP.addEventListener('click',prev);bN.addEventListener('click',next);document.addEventListener('keydown',(e)=>{if(!lb.classList.contains('open'))return;if(e.key==='Escape')close();if(e.key==='ArrowLeft')prev();if(e.key==='ArrowRight')next();});})();